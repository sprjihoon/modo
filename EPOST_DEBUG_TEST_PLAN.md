# 우체국 수거예약 디버깅 테스트 플랜

## 📋 현재 상황 분석

### ✅ 확인된 사항
- InsertOrder API 호출 성공 (송장번호: 6896770094291)
- resDate: 20251201 (오늘 날짜)
- API 파라미터 검증 완료
- 계약 승인번호 조회 성공

### ❌ 문제점
- getResInfo API 호출이 시작되지만 응답이 나타나지 않음
- treatStusCd 값 확인 불가
- 수거예약 실제 등록 여부 확인 불가

## 🧪 테스트 시나리오

### 단계 1: Mock 모드 테스트 (안전한 테스트)
**목적**: 코드 로직 검증 및 로그 출력 확인

1. Flutter 앱에서 `testMode: true` 설정
2. 수거예약 진행
3. 로그에서 다음 확인:
   - `⏳ getResInfo API 호출 시작...` 로그
   - `🚀 getResInfo 함수 호출 직전...` 로그
   - `✅ getResInfo 함수 호출 완료!` 로그
   - Mock 응답 데이터 확인

### 단계 2: 실제 API 모드 테스트 (실제 수거예약)
**목적**: 실제 우체국 API 연동 및 treatStusCd 확인

1. Flutter 앱에서 `testMode: false` 설정
2. 수거예약 진행
3. 로그에서 다음 확인:
   - `⏳ getResInfo API 호출 시작...` 로그
   - `🚀 getResInfo 함수 호출 직전...` 로그
   - `✅ fetch 호출 성공` 로그
   - `📥 우체국 응답 (XML 전체):` 로그
   - `treatStusCd` 값 (00, 01, 02, 03, 04, 05 중 하나)

### 단계 3: 타임아웃/에러 테스트
**목적**: 네트워크 문제나 API 제한 확인

1. 여러 번 반복 테스트
2. 각 테스트 간격 1분 이상
3. 에러 발생 시 로그 확인:
   - `⏰ fetch 타임아웃 발생 (30초)` 로그
   - `❌ fetch 호출 중 에러 발생` 로그

## 📊 예상 결과 분석

### treatStusCd 값 의미
- `00`: 신청준비 - 수거예약이 접수되었으나 아직 처리되지 않음
- `01`: 소포신청 - 수거예약이 정상 등록됨
- `02`: 운송장출력 - 수거원이 배정됨
- `03`: 집하완료 - 물품 수거 완료
- `04`: 배송중 - 배송 진행중
- `05`: 배송완료 - 배송 완료

### 문제 해결 가이드
- treatStusCd가 `00` 또는 `01`이면: 수거예약 정상 등록
- treatStusCd가 없거나 에러면: API 호출 문제 또는 계약 미완료
- 타임아웃 발생 시: 네트워크 문제 또는 우체국 API 서버 문제

## 🔍 디버깅 포인트

### 1. getResInfo API 호출 실패 원인
- 네트워크 타임아웃 (30초)
- 우체국 API 서버 문제
- XML 파싱 에러
- 계약 상태 문제

### 2. treatStusCd 값 이상
- 계약이 완료되지 않은 상태
- API 키나 파라미터 문제
- 우체국 시스템 내부 문제

### 3. 로그 분석 방법
```
✅ fetch 호출 성공 → 네트워크 연결 OK
📥 우체국 응답 (XML 전체) → API 응답 수신 OK
treatStusCd: "01" → 수거예약 정상 등록
```

## 🎯 다음 단계

1. **Mock 모드 테스트 진행**
2. **로그에서 getResInfo 호출 성공 확인**
3. **실제 API 모드 테스트 진행**
4. **treatStusCd 값 확인**
5. **필요시 우체국 담당자와 연락**
