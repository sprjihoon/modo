# ê³ ê° í–‰ë™ ë¶„ì„ ì‹œìŠ¤í…œ ê³ ë„í™” ê³„íš

## ğŸ“Š í˜„ì¬ ì‹œìŠ¤í…œ vs ì—…ê³„ í‘œì¤€ ë¹„êµ

### âœ… í˜„ì¬ êµ¬í˜„ëœ ê¸°ëŠ¥
- [x] ê¸°ë³¸ ì´ë²¤íŠ¸ ì¶”ì  (34ê°€ì§€ ì´ë²¤íŠ¸ íƒ€ì…)
- [x] í¼ë„ ë¶„ì„
- [x] ì´íƒˆ ì§€ì  ë¶„ì„
- [x] ê¸°ë³¸ ì „í™˜ìœ¨ ë¶„ì„
- [x] ë””ë°”ì´ìŠ¤/ì„¸ì…˜ ì •ë³´ ìˆ˜ì§‘

### ğŸ¯ ì¶”ê°€ í•„ìš” ê¸°ëŠ¥ (ì—…ê³„ í‘œì¤€ ê¸°ë°˜)

#### 1ï¸âƒ£ **ì„¸ì…˜ ë¶„ì„** (Google Analytics, Amplitude)
- ì„¸ì…˜ë‹¹ í‰ê·  ì²´ë¥˜ ì‹œê°„
- ì„¸ì…˜ë‹¹ ì´ë²¤íŠ¸ ìˆ˜
- ë°”ìš´ìŠ¤ìœ¨ (ë‹¨ì¼ ì´ë²¤íŠ¸ ì„¸ì…˜)
- ì„¸ì…˜ ê¹Šì´ (í˜ì´ì§€ë·° ìˆ˜)

#### 2ï¸âƒ£ **ì½”í˜¸íŠ¸ ë¶„ì„** (Mixpanel, Amplitude)
- ì¼ë³„/ì£¼ë³„/ì›”ë³„ ì½”í˜¸íŠ¸
- ë¦¬í…ì…˜ ë§¤íŠ¸ë¦­ìŠ¤
- Nì¼ í›„ ì¬ë°©ë¬¸ìœ¨

#### 3ï¸âƒ£ **ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ ë¶„ì„** (Segment, Mixpanel)
- ì‹ ê·œ vs ì¬ë°©ë¬¸ ê³ ê°
- ê³ ê°€ì¹˜ ê³ ê° ì‹ë³„
- í–‰ë™ ê¸°ë°˜ ì„¸ê·¸ë¨¼íŠ¸

#### 4ï¸âƒ£ **ì‹œê°„ íŒ¨í„´ ë¶„ì„** (Google Analytics)
- ì‹œê°„ëŒ€ë³„ í™œë™ íŒ¨í„´
- ìš”ì¼ë³„ ì „í™˜ìœ¨
- ì›”ë³„ íŠ¸ë Œë“œ

#### 5ï¸âƒ£ **ê³ ê° ì—¬ì • ì‹œê°í™”** (Amplitude Journey)
- Sankey ë‹¤ì´ì–´ê·¸ë¨
- ë‹¤ë‹¨ê³„ ì—¬ì • ë¶„ì„
- ìµœì  ê²½ë¡œ vs ì‹¤ì œ ê²½ë¡œ

#### 6ï¸âƒ£ **ë¦¬í…ì…˜ ë¶„ì„** (Mixpanel Retention)
- N-Day Retention
- Unbounded Retention
- ì¬êµ¬ë§¤ìœ¨

#### 7ï¸âƒ£ **ê³ ê° ìƒì•  ê°€ì¹˜ (LTV)** (ëª¨ë“  í”Œë«í¼)
- í‰ê·  ì£¼ë¬¸ ê¸ˆì•¡
- êµ¬ë§¤ ë¹ˆë„
- ê³ ê° ìˆ˜ëª…

#### 8ï¸âƒ£ **A/B í…ŒìŠ¤íŠ¸ ì§€ì›** (Optimizely, Google Optimize)
- ì‹¤í—˜ ê·¸ë£¹ ê´€ë¦¬
- í†µê³„ì  ìœ ì˜ì„± ê²€ì¦

#### 9ï¸âƒ£ **ì˜ˆì¸¡ ë¶„ì„** (Amplitude Recommend)
- ì´íƒˆ ìœ„í—˜ ì˜ˆì¸¡
- êµ¬ë§¤ í™•ë¥  ì˜ˆì¸¡
- ë‹¤ìŒ í–‰ë™ ì˜ˆì¸¡

#### ğŸ”Ÿ **ì‹¤ì‹œê°„ ì•Œë¦¼** (Heap, Amplitude Alerts)
- ì´ìƒ íŒ¨í„´ ê°ì§€
- ëª©í‘œ ë‹¬ì„± ì•Œë¦¼
- ì„ê³„ê°’ ì•Œë¦¼

---

## ğŸ”§ êµ¬í˜„ ìš°ì„ ìˆœìœ„

### Phase 1: ì¦‰ì‹œ êµ¬í˜„ (1-2ì¼)
âœ… **ì„¸ì…˜ ë¶„ì„**
âœ… **ì‹œê°„ íŒ¨í„´ ë¶„ì„**
âœ… **ë””ë°”ì´ìŠ¤ë³„ ìƒì„¸ ë¶„ì„**

### Phase 2: ë‹¨ê¸° êµ¬í˜„ (1ì£¼)
â³ **ì½”í˜¸íŠ¸ ë¶„ì„**
â³ **ë¦¬í…ì…˜ ë¶„ì„**
â³ **ê³ ê° ì„¸ê·¸ë¨¼íŠ¸**

### Phase 3: ì¤‘ê¸° êµ¬í˜„ (2ì£¼)
â³ **ê³ ê° ì—¬ì • ì‹œê°í™”**
â³ **LTV ë¶„ì„**
â³ **A/B í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬**

### Phase 4: ì¥ê¸° êµ¬í˜„ (1ê°œì›”+)
â³ **ì˜ˆì¸¡ ë¶„ì„ (ML)**
â³ **ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ**

---

## ğŸ“ˆ Phase 1 ìƒì„¸ êµ¬í˜„ì•ˆ

### 1. ì„¸ì…˜ ë¶„ì„

#### ë°ì´í„°ë² ì´ìŠ¤ ê°œì„ 
```sql
-- ì„¸ì…˜ ìš”ì•½ ë·° ìƒì„±
CREATE OR REPLACE VIEW customer_session_summary AS
SELECT 
  session_id,
  user_id,
  MIN(created_at) as session_start,
  MAX(created_at) as session_end,
  EXTRACT(EPOCH FROM (MAX(created_at) - MIN(created_at))) as duration_seconds,
  COUNT(*) as event_count,
  COUNT(DISTINCT event_type) as unique_event_types,
  device_type,
  device_os,
  app_version
FROM customer_events
WHERE session_id IS NOT NULL
GROUP BY session_id, user_id, device_type, device_os, app_version;

-- ì„¸ì…˜ ë©”íŠ¸ë¦­ ë·°
CREATE OR REPLACE VIEW session_metrics AS
SELECT 
  DATE(session_start) as date,
  COUNT(*) as total_sessions,
  AVG(duration_seconds) as avg_duration,
  AVG(event_count) as avg_events_per_session,
  COUNT(*) FILTER (WHERE event_count = 1) as bounce_sessions,
  ROUND(
    100.0 * COUNT(*) FILTER (WHERE event_count = 1) / COUNT(*),
    2
  ) as bounce_rate
FROM customer_session_summary
GROUP BY DATE(session_start)
ORDER BY date DESC;
```

#### API ì¶”ê°€
```typescript
// GET /api/analytics/customer-behavior?type=session
// Response:
{
  "avgDuration": 180,  // ì´ˆ
  "avgEventsPerSession": 8.5,
  "bounceRate": 35.2,  // %
  "totalSessions": 1250
}
```

#### ëŒ€ì‹œë³´ë“œ ì»´í¬ë„ŒíŠ¸
- ì„¸ì…˜ ì²´ë¥˜ ì‹œê°„ ì°¨íŠ¸
- ì„¸ì…˜ë‹¹ ì´ë²¤íŠ¸ ìˆ˜ ë¶„í¬
- ë°”ìš´ìŠ¤ìœ¨ íŠ¸ë Œë“œ

---

### 2. ì‹œê°„ íŒ¨í„´ ë¶„ì„

#### ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬
```sql
-- ì‹œê°„ëŒ€ë³„ í™œë™
CREATE OR REPLACE VIEW hourly_activity AS
SELECT 
  EXTRACT(HOUR FROM created_at) as hour_of_day,
  event_type,
  COUNT(*) as event_count,
  COUNT(DISTINCT session_id) as unique_sessions
FROM customer_events
GROUP BY EXTRACT(HOUR FROM created_at), event_type
ORDER BY hour_of_day, event_count DESC;

-- ìš”ì¼ë³„ ì „í™˜ìœ¨
CREATE OR REPLACE VIEW daily_conversion AS
SELECT 
  TO_CHAR(created_at, 'Day') as day_of_week,
  EXTRACT(DOW FROM created_at) as day_number,
  COUNT(*) FILTER (WHERE event_type = 'ORDER_START') as orders_started,
  COUNT(*) FILTER (WHERE event_type = 'ORDER_PAYMENT_SUCCESS') as orders_completed,
  ROUND(
    100.0 * COUNT(*) FILTER (WHERE event_type = 'ORDER_PAYMENT_SUCCESS') / 
    NULLIF(COUNT(*) FILTER (WHERE event_type = 'ORDER_START'), 0),
    2
  ) as conversion_rate
FROM customer_events
GROUP BY TO_CHAR(created_at, 'Day'), EXTRACT(DOW FROM created_at)
ORDER BY day_number;
```

#### ëŒ€ì‹œë³´ë“œ ì»´í¬ë„ŒíŠ¸
- íˆíŠ¸ë§µ: ì‹œê°„ëŒ€ x ìš”ì¼ë³„ í™œë™
- ì‹œê°„ëŒ€ë³„ ì „í™˜ìœ¨ ë¼ì¸ ì°¨íŠ¸
- í”¼í¬ íƒ€ì„ í‘œì‹œ

---

### 3. ë””ë°”ì´ìŠ¤ë³„ ìƒì„¸ ë¶„ì„

#### ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬
```sql
-- ë””ë°”ì´ìŠ¤ë³„ ì „í™˜ í¼ë„
CREATE OR REPLACE VIEW device_conversion_funnel AS
SELECT 
  device_type,
  device_os,
  COUNT(DISTINCT session_id) as total_sessions,
  COUNT(*) FILTER (WHERE event_type = 'CART_ADD') as cart_adds,
  COUNT(*) FILTER (WHERE event_type = 'ORDER_START') as order_starts,
  COUNT(*) FILTER (WHERE event_type = 'ORDER_PAYMENT_START') as payment_attempts,
  COUNT(*) FILTER (WHERE event_type = 'ORDER_PAYMENT_SUCCESS') as completed_orders,
  ROUND(
    100.0 * COUNT(*) FILTER (WHERE event_type = 'ORDER_PAYMENT_SUCCESS') / 
    NULLIF(COUNT(*) FILTER (WHERE event_type = 'ORDER_START'), 0),
    2
  ) as conversion_rate,
  AVG(
    CASE 
      WHEN event_type IN ('ORDER_PAYMENT_START', 'ORDER_PAYMENT_SUCCESS')
      THEN (metadata->>'amount')::numeric
    END
  ) as avg_order_value
FROM customer_events
GROUP BY device_type, device_os
ORDER BY completed_orders DESC;
```

#### ëŒ€ì‹œë³´ë“œ ì»´í¬ë„ŒíŠ¸
- ë””ë°”ì´ìŠ¤ë³„ ì „í™˜ìœ¨ ë¹„êµ ì°¨íŠ¸
- OSë³„ ì„±ê³¼ í…Œì´ë¸”
- ë””ë°”ì´ìŠ¤ë³„ í‰ê·  ì£¼ë¬¸ ê¸ˆì•¡

---

## ğŸ¨ ëŒ€ì‹œë³´ë“œ UI ê°œì„ ì•ˆ

### ìƒˆë¡œìš´ íƒ­ êµ¬ì¡°
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Overview | Funnel | Sessions |     â”‚
â”‚  Time Patterns | Devices | Cohorts â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Overview íƒ­
- KPI ì¹´ë“œ (ì´ ì´ë²¤íŠ¸, í™œì„± ì‚¬ìš©ì, ì „í™˜ìœ¨, AOV)
- ì¼ë³„ íŠ¸ë Œë“œ ì°¨íŠ¸
- ì‹¤ì‹œê°„ í™œë™ í”¼ë“œ

### Sessions íƒ­ (ì‹ ê·œ)
- ì„¸ì…˜ ë©”íŠ¸ë¦­ ìš”ì•½
- ì„¸ì…˜ ì²´ë¥˜ ì‹œê°„ ë¶„í¬
- ë°”ìš´ìŠ¤ìœ¨ íŠ¸ë Œë“œ
- ì„¸ì…˜ë‹¹ ì´ë²¤íŠ¸ ìˆ˜ ë¶„í¬

### Time Patterns íƒ­ (ì‹ ê·œ)
- 24ì‹œê°„ í™œë™ íˆíŠ¸ë§µ
- ìš”ì¼ë³„ ì „í™˜ìœ¨ ë°” ì°¨íŠ¸
- ì›”ë³„ ì„±ì¥ íŠ¸ë Œë“œ
- í”¼í¬ íƒ€ì„ ì¸ì‚¬ì´íŠ¸

### Devices íƒ­ (ì‹ ê·œ)
- ë””ë°”ì´ìŠ¤ íƒ€ì…ë³„ ì „í™˜ìœ¨
- OSë³„ ì„±ê³¼ ë¹„êµ
- ì•± ë²„ì „ë³„ ë¶„ì„
- ë””ë°”ì´ìŠ¤ë³„ í‰ê·  ì£¼ë¬¸ ê¸ˆì•¡

---

## ğŸ“Š Phase 2 ë¯¸ë¦¬ë³´ê¸°: ì½”í˜¸íŠ¸ ë¶„ì„

### ì½”í˜¸íŠ¸ í…Œì´ë¸” ì˜ˆì‹œ
```
         | Day 0 | Day 1 | Day 7 | Day 30
---------|-------|-------|-------|--------
2024-01  | 100%  | 45%   | 23%   | 12%
2024-02  | 100%  | 48%   | 25%   | 15%
2024-03  | 100%  | 52%   | 28%   | 18%
```

### êµ¬í˜„ ê°œìš”
```sql
-- ì½”í˜¸íŠ¸ ì •ì˜
WITH cohorts AS (
  SELECT 
    user_id,
    DATE(MIN(created_at)) as cohort_date
  FROM customer_events
  WHERE event_type = 'APP_OPEN'
  GROUP BY user_id
),
-- ì¬ë°©ë¬¸ ì¶”ì 
retention AS (
  SELECT 
    c.cohort_date,
    DATE(e.created_at) as activity_date,
    DATE(e.created_at) - c.cohort_date as days_since_first,
    COUNT(DISTINCT e.user_id) as active_users
  FROM cohorts c
  JOIN customer_events e ON c.user_id = e.user_id
  GROUP BY c.cohort_date, DATE(e.created_at)
)
SELECT * FROM retention;
```

---

## ğŸ“± Flutter ì•± ì¶”ê°€ í†µí•©

### ì„¸ì…˜ ì‹œì‘/ì¢…ë£Œ ëª…ì‹œì  ì¶”ì 
```dart
// ì•± ì‹œì‘
await CustomerEventService.trackEvent(
  eventType: CustomerEventType.APP_OPEN,
  metadata: {
    'session_start': true,
    'previous_session_end': lastSessionEnd,
  },
);

// ì•± ì¢…ë£Œ/ë°±ê·¸ë¼ìš´ë“œ
await CustomerEventService.trackEvent(
  eventType: CustomerEventType.APP_CLOSE,
  metadata: {
    'session_duration': sessionDuration,
    'events_in_session': eventCount,
  },
);
```

### í˜ì´ì§€ë³„ ì²´ë¥˜ ì‹œê°„
```dart
class _PageState extends State<Page> {
  DateTime? _pageEnterTime;
  
  @override
  void initState() {
    super.initState();
    _pageEnterTime = DateTime.now();
    CustomerEventService.trackPageView(pageTitle: 'Page Name');
  }
  
  @override
  void dispose() {
    if (_pageEnterTime != null) {
      final duration = DateTime.now().difference(_pageEnterTime!);
      CustomerEventService.trackEvent(
        eventType: CustomerEventType.PAGE_VIEW,
        metadata: {
          'page_exit': true,
          'time_spent_seconds': duration.inSeconds,
        },
      );
    }
    super.dispose();
  }
}
```

---

## ğŸ¯ ê¸°ëŒ€ íš¨ê³¼

### Phase 1 ì™„ë£Œ í›„
- âœ… ì„¸ì…˜ í’ˆì§ˆ ë¶„ì„ ê°€ëŠ¥
- âœ… ì‹œê°„ëŒ€ë³„ ìµœì í™” ê°€ëŠ¥
- âœ… ë””ë°”ì´ìŠ¤ë³„ UX ê°œì„  ê°€ëŠ¥
- âœ… ë°”ìš´ìŠ¤ìœ¨ ê°ì†Œ ì „ëµ ìˆ˜ë¦½

### Phase 2 ì™„ë£Œ í›„
- âœ… ë¦¬í…ì…˜ ê°œì„  ì „ëµ ìˆ˜ë¦½
- âœ… ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ë³„ ë§ì¶¤ ë§ˆì¼€íŒ…
- âœ… LTV ê¸°ë°˜ ê³ ê° ê´€ë¦¬

### Phase 3 ì™„ë£Œ í›„
- âœ… ë°ì´í„° ê¸°ë°˜ ì œí’ˆ ê°œì„ 
- âœ… A/B í…ŒìŠ¤íŠ¸ ê¸°ë°˜ ì˜ì‚¬ê²°ì •
- âœ… ì˜ˆì¸¡ ê¸°ë°˜ ì„ ì œì  ëŒ€ì‘

---

## ğŸ“‹ ì‹¤í–‰ ê³„íš

### ì´ë²ˆ ì£¼ (Phase 1)
- [ ] ì„¸ì…˜ ë¶„ì„ SQL ë·° ìƒì„±
- [ ] ì‹œê°„ íŒ¨í„´ ë¶„ì„ API êµ¬í˜„
- [ ] ë””ë°”ì´ìŠ¤ë³„ ë¶„ì„ ëŒ€ì‹œë³´ë“œ ì¶”ê°€
- [ ] Flutter ì•± ì„¸ì…˜ ì¶”ì  ê°•í™”

### ë‹¤ìŒ ì£¼ (Phase 2 ì¤€ë¹„)
- [ ] ì½”í˜¸íŠ¸ ë¶„ì„ ì„¤ê³„
- [ ] ë¦¬í…ì…˜ ë©”íŠ¸ë¦­ ì •ì˜
- [ ] ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ ë¡œì§ êµ¬í˜„

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2024-12-18  
**ì‘ì„±ì**: AI Assistant  
**ë²„ì „**: 2.0.0  
**ì°¸ê³ **: Google Analytics 4, Mixpanel, Amplitude, Heap Analytics

